<h2>Coinbase</h2>

<div class="row g-0">
    <div class="col-4">
        <div class="p-1">
            <app-kpi *ngIf="etatGlobal"  
                [valeur]="etatGlobal.etat.totalAchete" 
                [titre]="'Acheté'" 
                [type]="'currency'" 
                [neutre]="true" >
            </app-kpi>
        </div>
    </div>
    <div class="col-4">
        <div class="p-1">
            <app-kpi *ngIf="etatGlobal" 
                [valeur]="etatGlobal.etat.totalFrais" 
                [titre]="'Frais'" 
                [type]="'currency'" 
                [neutre]="true" >
            </app-kpi>
        </div>
    </div>
    <div class="col-4">
        <div class="p-1">
            <app-kpi *ngIf="etatGlobal" 
                [valeur]="etatGlobal.etat.totalDepense" 
                [titre]="'Dépensé'" 
                [type]="'currency'" 
                [neutre]="true" >
            </app-kpi>
        </div>
    </div>
</div>
<div class="row g-0">
    <div class="col-6">
        <div class="p-1">
            <app-kpi *ngIf="etatGlobal" 
                [valeur]="etatGlobal.etat.sante" 
                [titre]="'Santé'" 
                [type]="'currency'"
                [variationPourcentage]="etatGlobal.variation.sante.pourcentage"
                [variationValeur]="etatGlobal.variation.sante.valeur"
                [typeVariation]="'pourcentage'"
                >
            </app-kpi>
        </div>
    </div>
    <div class="col-6">
        <div class="p-1">
            <app-kpi *ngIf="etatGlobal" 
                [valeur]="etatGlobal.etat.totalPrix" 
                [titre]="'Etat'" 
                [type]="'currency'" 
                [neutre]="true" 
                [variationPourcentage]="etatGlobal.variation.etat.pourcentage"
                [variationValeur]="etatGlobal.variation.etat.valeur"
                [typeVariation]="'pourcentage'"
                >
            </app-kpi>
        </div>
    </div>
</div>

<table mdbTable hover="true" responsive="true" *ngIf="listeCryptos">
    <thead>
        <tr>
            <th [mdbTableSort]="listeCryptos" sortBy="code.code">ID</th>
            <th [mdbTableSort]="listeCryptos" sortBy="prix_unitaire.data.amount">Prix unitaire</th>
            <th [mdbTableSort]="listeCryptos" sortBy="quantite">Quantité</th>
            <th [mdbTableSort]="listeCryptos" sortBy="prix">Prix</th>
            <th >Cours semaine</th>
            <th [mdbTableSort]="listeCryptos" sortBy="etat.sante">Montant</th>
        </tr>
    </thead>
    <tbody>
        <tr mdbTableCol *ngFor="let crypto of listeCryptos">
            <th scope="row">{{ crypto.code.code }}</th>
            <td>{{ crypto.prix_unitaire.data.amount | currency:'EUR':'symbol':'1.2-2' }}</td>
            <td>{{ crypto.quantite | number: '.2-8' }}</td>
            <td>{{ crypto.prix | currency:'EUR':'symbol':'1.2-2'  }}</td>
            <td >

                <app-line-chart
                    [values]="crypto.historique_cours_semaine.prix"
                    [labels]="crypto.historique_cours_semaine.dates"
                    [borderColor]="'rgb(61, 90, 254)'"
                    [backgroundColor]="'rgb(232, 234, 246)'"
                ></app-line-chart>

            </td>
            <td>
                <span *ngIf="crypto.etat.sante < 0" class="deep-orange-text font-weight-bold" >{{ crypto.etat.sante | currency:'EUR':'symbol':'1.2-2'  }}</span>
                <span *ngIf="crypto.etat.sante >= 0" class="teal-text font-weight-bold" >{{ crypto.etat.sante | currency:'EUR':'symbol':'1.2-2'  }}</span> 
            </td>
        </tr>
    </tbody>
</table>

<div class="d-flex justify-content-center" *ngIf="!listeCryptos">
    <div class="spinner-border" role="status">
        <span class="sr-only">Loading...</span>
    </div>
</div>